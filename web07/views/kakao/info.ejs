<div class="my-5 row justify-content-center">
    <h1 class="text-center mb-5"><%= title %></h1>
    <div class="card col-md-10">
        <div class="row card-body p-3">
            <div class="col-lg-4 mb-3 text-center">
                <img src=<%= info.thumbnail %> width="80%">
            </div>
            <div class="col align-self-center">
                <h5><%= info.title %></h5>
                <hr>
                <div class="mb-3">ISBN: <%= info.isbn %></div>
                <div class="mb-3">ê°€ê²©: <%= info.price %>ì›</div>
                <div class="mb-3">ì €ì: <%= info.authors %></div>
                <div class="mb-3">ì¶œíŒì‚¬: <%= info.publisher %>ì›</div>
                <div class="my-3">
                    <button class="btn btn-success px-5 cart">ì¥ë°”êµ¬ë‹ˆ</button>
                    <button class="btn btn-warning px-5">ë°”ë¡œêµ¬ë§¤</button>
                </div>
            </div>
            <hr>
            <div><%= info.contents %></div>
        </div>
    </div>
</div>
<!--ì‹œí—˜-->
<script type="module">

    import {app} from '/javascripts/config.js';
    import {getDatabase, ref, set, get} from "https://www.gstatic.com/firebasejs/10.14.1/firebase-database.js";
    const db = getDatabase(app);

    const isbn = "<%=info.isbn%>";
    const title = "<%=info.title%>";
    const price = "<%=info.price%>";
    const authors = "<%=info.authors%>";
    const publisher = "<%=info.publisher%>";
    const contents = "<%=info.contents%>";
    const thumbnail = "<%=info.thumbnail%>";

    const info = {isbn,title,price,authors,publisher,contents,thumbnail}
    //ì¥ë°”êµ¬ë‹ˆë¥¼ í´ë¦­í•œ ê²½ìš°
    $(".cart").on("click", async function () {
        if (email) {
            //í˜„ì¬ë„ì„œë¥¼ ì¥ë°”êµ¬ë‹ˆì— ë„£ê¸°
            const ref_cart = ref(db,`cart/${uid}/${isbn}`);
            const snapshot = await get(ref_cart);
            if (snapshot.val()){
                alert("ì´ë¯¸ ì¥ë°”êµ¬ë‹ˆì— ìˆìŠµë‹ˆë‹¤");
            }else{
                await set(ref_cart, info);
                alert("ì¥ë°”êµ¬ë‹ˆì— ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤ğŸ¤©");
            }
        } else {
            sessionStorage.setItem("target", window.location.href);
            location.href = "/users/login";
        }
    });
</script>